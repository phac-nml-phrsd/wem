<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Short-tutorial</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Short-tutorial</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The package <code>wem</code> stands for “Wastewater Epidemic Model”. It implements an epidemic model that can include pathogen concentration in wastewater as a source of data in addition to the more traditional case incidence and hospitalization data.</p>
<p>The epidemic model that represents pathogen transmission in the population is a deterministic SEIR-type compartmental model.</p>
<p>A simple advection-dispersion-decay model is used to simulate the fate of SARS-CoV-2 along its journey in wastewater from the shedding points to the sampling site. This model is a combination of an exponential viral decay and a dispersed plug-flow function representing all possible hydrodynamic processes (e.g., dilution, sedimentation and resuspension) that leads to RNA degradation as well as decrease and delay of signal at the time of sampling.</p>
<p>For more details on the model, see <a href="https://www.medrxiv.org/content/10.1101/2021.07.19.21260773v1">Nourbakhsh et al. (medRxiv 2021)</a>.</p>
</div>
<div id="a-simple-example" class="section level2">
<h2>A simple example</h2>
<p>This section provides a simple example of how key functions from the <code>wem</code> package can be used for real-life applications.</p>
<div id="simulating-an-epidemic" class="section level3">
<h3>Simulating an epidemic</h3>
<p>The wastewater-epidemic model has many parameters and user will typically define them in a CSV file for convenience. See <code>?wem::load_prm()</code> for loading parameters from a csv file.</p>
<p>Here, we’ll use a built-in function <code>model_prm_example()</code> that provides an example (inspired by SARS-CoV-2 epidemic parameters) of values for all the model parameters.</p>
<p>Once the model parameters are defined, the model can simulate epidemic trajectories (i.e., time series of reported cases and pathogen concentration in wastewater).</p>
<p>First, let’s load all model parameters in a variable:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wem)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load a pre-defined model parameters as an example:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>prm.model <span class="ot">=</span> <span class="fu">model_prm_example</span>()</span></code></pre></div>
<p>Among all parameters defined here, we have (for example):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the basic reproduction number R0:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prm.model<span class="sc">$</span>R0)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the time horizon of the simulation</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prm.model<span class="sc">$</span>horizon)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 200</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># the time decay of the pathogen in the wastewater</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prm.model<span class="sc">$</span>decay.rate)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.18</span></span></code></pre></div>
<p>Given that there are many model parameters, it may be helpful to display them all in a synthetic “dashboard-like” way:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>g.dash <span class="ot">=</span> <span class="fu">plot_dashboard_prm</span>(<span class="at">prm =</span> prm.model, <span class="at">textsize =</span> <span class="dv">7</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g.dash)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; geom_path: Each group consists of only one observation. Do you need to adjust</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; the group aesthetic?</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; geom_path: Each group consists of only one observation. Do you need to adjust</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; the group aesthetic?</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now that all model parameters are defined, we can simulate an epidemic:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">=</span> <span class="fu">simul</span>(<span class="at">prm =</span> prm.model)</span></code></pre></div>
<p>The object returned by <code>simul()</code> is a list and the element named <code>ts</code> is a dataframe that records the time series of epidemiological variables, including prevalence of infection and pathogen concentration in wastewater.</p>
<p>We can visualize the time series of selected epidemiological variables (susceptible population size <code>S</code>, incidence <code>inc</code>, hospital admissions <code>hosp.admission</code>, vaccinated individuals <code>V</code>, reported clinical cases <code>report</code>, viral concentration in wastewater <code>concen</code>) using the function <code>plot_epidemic()</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>g.all <span class="ot">=</span> <span class="fu">plot_epidemic</span>(<span class="at">df =</span> sim<span class="sc">$</span>ts)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g.all)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>All the model variables can be plotted with the function <code>wem::plot_all()</code>.</p>
<p>Simulations of epidemics with known parameters are often used in theoretical studies or explorations (“what-if” scenarios).</p>
</div>
<div id="fitting-to-observed-data" class="section level3">
<h3>Fitting to observed data</h3>
<div id="loading-data" class="section level4">
<h4>Loading data</h4>
<p>Another typical use of epidemic models is to fit them (i.e., their parameters) to observed data. The package <code>wem</code> comes with example data sets of COVID reported cases and COVID-associated hospital admissions as well as SARS-CoV-2 concentration in wastewater.</p>
<p>Let’s load those data sets to use them in the fitting example that follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cases, <span class="at">package =</span> <span class="st">&#39;wem&#39;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(hosp, <span class="at">package =</span> <span class="st">&#39;wem&#39;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(wwviralconc, <span class="at">package =</span> <span class="st">&#39;wem&#39;</span>)</span></code></pre></div>
<p>Now we use the datasets to build a data object properly formatted that will be read by the model</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">build_data</span>(<span class="at">cases     =</span> cases, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">hosp      =</span> hosp,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ww        =</span> wwviralconc, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">hosp.type =</span> <span class="st">&#39;hosp.adm&#39;</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">case.date.type =</span> <span class="st">&#39;report&#39;</span>)</span></code></pre></div>
<p>The data object is simply a list storing all data in a single dataframe, either in the wide or long format, as well as other information (like the type of hospital data, if provided). It is also necessary to identify the type of date for clinical cases in <code>case.date.type</code> - whether it is based on reported date or episode date. The different data sources have been merged together, taking into account that they may not have the same time points (in that case, missing data for a given date is filled with <code>NA</code>)</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dat<span class="sc">$</span>obs, <span class="at">n =</span> <span class="dv">10</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">date</th>
<th align="right">time</th>
<th align="right">clin.obs</th>
<th align="right">ww.obs</th>
<th align="right">hosp.obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2021-01-02</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2021-01-03</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2021-01-04</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2021-01-05</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2021-01-06</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2021-01-07</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2021-01-08</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2021-01-09</td>
<td align="right">8</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2021-01-10</td>
<td align="right">9</td>
<td align="right">7</td>
<td align="right">NA</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2021-01-12</td>
<td align="right">11</td>
<td align="right">2</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Let’s visualize the observed data (we use the “long” format object <code>obs.long</code>, as it it more convenient with <code>ggplot2</code>):</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>g.data <span class="ot">=</span> dat<span class="sc">$</span>obs.long <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g.data)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAEgCAMAAABcujGyAAABZVBMVEUAAAAAADoAAGYAOpAAZrYZGT8ZGWIZP2IZP4EZYp8aGhozMzM6AAA6ADo6AGY6kNs/GRk/GT8/GWI/P4E/Yp8/gb1NTU1NTW5NTY5Nbo5NbqtNjshiGRliGT9iGWJiPxliYhliYj9iYmJigYFin9lmAABmADpmtv9uTU1uTW5uTY5ubo5ubqtujqtujshuq+SBPxmBPz+BYhmBgT+BgWKBvdmOTU2OTW6OTY6Obk2Obm6ObquOjm6Ojo6OjsiOyP+QOgCQkGaQ27aQ2/+fYhmfYj+fvYGf2Z+f2dmrbk2rbm6rbo6rjk2rjqurq26rq46ryKur5Mir5P+2ZgC22/+2//+9gT+9vYG92dnIjk3Ijm7IyI7I5KvI/+TI///Zn2LZvYHZ2Z/Z2b3Z2dnbkDrb/7bb///kq27kq47k/8jk///r6+v/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///8DsSi0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAVGElEQVR4nO2diZ/UthXHBaEtR1rSpFkoEHpBOUq7TRuOtE2HFnIQeiS7hTJpurBZGlqGpZ1d1n9/Ld8aW9KTbMmy/XsfmPHq2Xr6Wd/RNbaHRTBYwMb6LgAMpjIACgvaACgsaAOgsKANgMKCNgAKC9rsAN0Zok1IzwjkAdAx6xmBPAA6Zj0jkAdAx6xnBPIA6Jj1jEAeAB2znhHIA6Bj1jMCeQB0zHpGIA+AjlnPCOSFAuiTNz+J/9XT717oLkZmLvU0aqhbp6pCArT76goI0MZ0AKo1AOpY8fa549+4nragT9761fHjF/LUb8aVfffHScLj48lfnZhbQH+YlDcrfVrs7fO/jhUmfheq/FbXV7+8sPPku9d3Hn/rB9nG0Uc7Dqurf0C54sdH/54C+sbbmeCdu+nW3aOP4vTt85/sPDzWRbQdx4BmAtLSZ8XePnf00eO0wlyo8ltdOw/f3nkYQ/jw7WKDpzqrrv4BTXvFrAWNt9O/ucbtd64nfcbdC3yrM3MKaCogK31W7O1zF3a+epdvOlHlGdAnbz368L1jsZ5iY8dldQUA6Fu8xVwFlL9y7R9eTwY2T97IO8n25gHQvPRpsZP6SkZnTlR5BnT7/MfnP3rz4/OfFBs7LqsrAEB1LSgfA8SWdf3tzQOgeel3kmLzrVpD050qz4Du3P3J9756971jlQ2X1dU/oMmo+82PVgAtBjXHeALfGhKgWemzYm+fO7Y6su5SlW9AHx9PB5/lxo7D6uofUGEWX/aQ5bSQdxZ3BzOLTwHNS5/O4t/5ERfhSpVvQJOpOy93vuG0ugIA1Ld519PpFK9u464uAApAgzYAOmY9I5AHQMesZwTyAOiY9YxAXjtAF6nl7zWTOmQes2Q7T1743bW101tRtH9j7cxzoh5jpbL9uztjpR5qdXV4MrurLq266QG6vLoVPTsbHdyb8TcAauMBoLb5qDyV8seQ7t/aSlgFoACU4PEMaNx0Lq89j/ZvbsR/nDhxwuokDMc6P5kA1DYflaco/fLyqY1o90wOKEEPWtA2ySoPAK04SovJLFtQAApAtR7PgEbzGcagLYIDUNt8VJ6s7FnffnBvHbN42+AA1DYflScv/LO1tXgMinXQFsEBqG0+Kk8LPQC0TbLKM1BAmW0+ykL5BpRJ0o0CBApogzYA2ioCAAWgLUoKQC1CA1AAqs9UkTxiQBkAtctHWSgA2lVwAGqbj7JQALSr4MED6tp8l6rzE5wCWq9FAEp2ZIYWFIACUL0HgFqEBqAAVJ+pInm8gDIsM1nmoywUAO0qOAC1zUdZKADaVXAAyizzURYKgHYVHICODlCdIAC66gCgANQ6+NQBZdr6BKB9AsqmfrHIWACtVCMANXUAUJ+AascsAHTVAUABqG3w6QLK8jcASgjdmzGPl/MAUIqe9oBmm2hByY7gAOWSAahJ6L4AZQsACkAJoQEoANVnqkgGoHoPAK04PAPKyoteik0ASnYAUABqGRyAAlBSaAA6GUCdWGW10OfCYYN1fDIBKFpQUuiJA/psjdsseT+9JTyt0B2gqW4ASgo9cUC58Ye9zmd8S/jVFgCqcwBQoqcdoPwZ7gefJs9xF56YDUB1jgzQcswCQE0dFEB5kxl37byjF361xcnPtvCSMJZtep5SdH6CASjR0wrQBMjllaQVFX61BS2ozhFlGqqAMot8lIdMHtDdYlY0nwm/2uIK0BzMMQKafvgAKNlBAHS+XmzNvIxB80rV94gAtGdAGwn1DGg6PeLN6MH9LeFXW9wAygCoWeipA5r16A2/2gJAdY4YUAZACZ52s3jrCgWgAJTmAaAVBwDtJvjEAWUAlBgagAJQfaay5Bqg41oHnSqgnFEASgwdFqBsOoCWNTsqQJVVCEBXHQDUMaCr66AA1MwBQJ0CylYvFlkAUDMHAAWglsGnDugCgNJCA9A+ABVqdtCAcgOgOhFSR6CALgAoOTQABaD6TCXJAJQoQuoAoD4ALdFcOAQ0uVA3u9xMfAOghmEBqGkAgp5dflt4dtut+AZATcPqAV0AUGrozOanPotb0OyWB/ENgJqGBaCmAahdfHbTmPgWObkJlxUvtdTuDYBS9AwA0Oy2W/FNkIcWlBAWgJoGaNuCAlCjsCEAurzMn0QhzHNbZCpJFgAtdbkDFGNQf4Bycwcob1iWVzaEeW6LTCXJ3gHNbrsV3yYLqAtjwgNv3JVrl9fbyo3+dhWlcPgHtO91UBYUoNZhA2hBua3Oc61OgtJY9Z2Jad7N+pSZAJomG1eK1BG1OWnWYcMAlHeAwjy3RaaS5KYWVFWF3U76AKhtWDmg+XV2mbkEdP/GehQJ89wWmUqSRwxo2pcDUKt8lIXKbHmZP5K3hzEoADVxhAeooNkdoCmf4jy3RaaS5EJLuWYGQI0ckwU0f/a+n3VQAKoRIXVMFlAbPQC0YgCUGwDVhwagAFSfqSQZgBJFSB0A1CWg4noEAAWgBA8A7SY4AOUGQPWhASgA1WfanCxKAaAAlOABoN0EB6DcAKg+dK+ArhIKQFtGAKAAlBAWgJoGAKAA1DGg+S+QAlAjBwAFoHbBpwto1QCoPjQABaD6TJuTmwFdMABKdjQC+pSxS09f+xqA0jNtTp4EoKJIH4Buvvavi5de3T4SAKDp3wAUgFZ07F28FP+LXhx+kPzJLz0/vaW40RqAAtBKqndA59m9O9IHTgJQGqCLUQJa+dylqR66+Ke8i9+7eDL54+DT5J5cxcN+ACgAraT6mCS9YLGlfPI+nd9b5uOBk/WC8L89PojDqqJUDgBKFSF1ZCanYHllg7eiigdOOm5BWXfnNHW4B5TVNlaSASjZoQU0sflM8cBJAEoEtPT3A2i3Vj52igmpbno8cZLEEssmSdyKp8D1MAYFoJrQZLMOoWxB65fE+GlB9356J3nnnfrB/S3FAycBKACtpHrr4l9kXyU9W1s7taF64CQABaCVRH+AVrp4ywoFoM17A1C6Qw7opv7LeOuwgQLalbHahsTv16xPWWCAZpOkQ3eIit0CavlMabSgfQGqUOdumQmA6jIV/gKgxiKkDgAKQO2C9wRovggqroMCUF2mYpmLrea9ASjdsQqokVmHNQHUbtQdNKDSdABacwBQAGoXvEdAX74eUhc/VEDZAoDSRUgdDYC+un3y1e3kmmUASs5UKHMB5zQArcjxAihHc/Nk8VUnAKVkKpQZgBqLkDokgD49EspXnQBUF3pygEabCZ2E+46twwJQ0wAAtGLxIDTa7OerzlrNAVBt6OkBaqgYgDYDygAoXYTUAUAdAiqtKgBKdjQAmt9w3AOg9YoDoNrQkwOUP5qJ6RdBAajMwdLLIhWA1nuKFqH7B1S8OsZLF7/Zz/WgDYAuAKgmdA+AZhPAHgHljPpfB22QNlJAZZ38wAFNv+P11ILq+QSgzY5JAMoW/QFK698dWEM7znzewWNcUc0OCqB5HVMDhA1oLsUPoJTLRGgVihZUvvuQAWX9AmqquDNAm0gcIKBsAUCNRUgdABSAGgevA5ppAaAtIyQOX4DG9QhAqSKkjtABlSfbREgcANQ0BABNbTyAZvOkqQGaUTo1QK0UTxZQ7W9edAFoqq9BdbIFQK0jJI5xA6r9zYv2JzObAgLQIn2sgNYJba1H/5sXAJQQ1my6DkCVoQXz8ZsXrPFJ38V3fk6++ZskoEnbUh2ltci0WtxFj4Dqf/PCUQtajllG24Iy2QGOAN3lkwlhlNYi02pxFxl7fQCamPI3LwAoIWwToPKnhLkBdH7qs7gFFUZpLTKtFnfRP6D+x6B5GgC1jpA7CuNVJ4zSrE5Czfi5ZMWLYje13870v3nhDtD8C3kAahchdxTGARVGaS0yrRZ3kVeWqgXldeyiBdX+5kXrk1mMsSWANi2faUVIHaEAmlZXny1op4BqvvRzCKi2ugAoIawhoBaKqYA6GoNOEdDFyAFVzOIdAiqM0lpkWi1u+QJAqSKkjiEAKr8Jsj2gjtZBJwlodQdTEVLHlAE11kNSSrnwDICSHQEBKj9AehNkuICq9wegZAcABaCGwQFow94ANDBAmeIAz4AuL/PLY1YuhO0aUKY8AIACUKkqvorNL5ERLoQFoHIHAPUL6C7HcT4TL4QFoHKHAaB1WQMAtLJKEQSgCZY3N8QLYaNur4AljIG9PP9Gd7a6BbS4Pq1yCABddWSmrH/+bYt4ISyxQsnngjUnV/aWiB5yCwpAKQ4CoPs31rOt4kJYACp3AFDvs/hZvllcCNsxoKw5ubo3AJU6Jg5oxqd4IWy3gGrrB4ACUKkqvv7Jp0fihbAAVOowB5QB0HaTJOsKNVGsOgCAAlAA2h7QStVp9h83oBYXnw0fUAmhABSAugaUUKEANDhAVQcAUMMIKw4AahoCgGoOGAqgbLWcEwXU/NIJAFpxAFDTEJMGlFKhAwKUjR1QUnsCQE0irDoCAXRRtLcAFIBWHS4BZRaAVi8LHQmgxsvWYQLKihfNAQC0Z0BZ4yYArSYPAdD01+0J+wNQsqNHQBkA9QuovbHGTeIRXZfAwEjVJvXUV2WGD6jBMtOoW1DT6gq3BSUD2iw5pBaHGf54ePKM2ygetfr6zXHrU1YdjE0J0FqD0zegLTJtLiChBc3qntmHBqBuAGULU0ANCACgnQPKjAA1bE8AaMUBQE1DiEXVHjBVQJueYzseQJl1aPeAMgtAGwkFoARPkIDmTeiIADXq8BwB2srMJ73OC6k7W5MFNContHRAG07IuFvQgMegzBbQfGo8CECpy7xFcu2MjBrQhdFHcgCApkemr+MEtHZKhgcoqyWr8gGgTY7QAWVNHmrofgGtPSFzwoCmW8ECmqMGQFX5hAto/Vtb5f4DBXS1ywOgK8kAtMkROKAMgJrFDh/Q2txRWSifgNLuaKkks+ECWltUUxwQOqDFFIJaiNX08AEtNgkHrABaOWZwgBIPGD+gi1VADZYQvQJKOQCA0iLIHIECmrwECChbSH/SEYCuJIcLaNT4PRcAXbnmdziANtcnAOUOZvYDNe4BZQQSJckAVBph4IAafEvoGlA2QUDLdQvSAUUyvV3xByjrEtBs7S3p5Gm32A8CUFb3kHIaHqDkdmVYgFZyWpRfzAcBaHIttTWg2QLaAAG16uKTZoVVV/j7B5R1CSgbH6DJi7a6RgNo+lo+HwGAuge0zSQpH7ywyiKFQU59AWqtuKyyUABl+TTX5AOnAbTpBspeAM1GxZ0AmkAaNqBVuloDmm2OCtCsKwwI0HxBwR7QXAhT5RMQoCwbRbZUvBgpoIugAC0H+x0AmrwHDmhlnNYe0PT09QMoyz9nRR12BWjEKoCW09/8I92wPuoYUOUxZsmhAyp8P9KFYo5I1LR6rylUa0DziAKgRoWQF05Y2e4H0Io8TXlNAS2WeumHeAW0+49kOa+gHzMkQMt70bObSsrWlaLHCtDiKbxOAGUVBfoAFoDa/pgs7XsRG8XVVSf9R6BWoVVB2nB5M1YGzxK8AVpfzjKtLpI6xpwAGpW5V9fvOwT04N7M8Oe4hXV1S2lqxUUdCsGIgAqC9OGyUJmx0AFtqi6VOjG2trzm1ZVv5N+3NAUTjzAEdP/WVrS8uqWq0DJyvkrREL5zxfk1QOnUJZ/CZLyKJ1suiBSuttTlENBFZQYs/inTo6+u+hw7/5yJZ8opoGXs9CW/IrqcHuZHGAK6vPY82r+5EW+diK04umpR+kzWZCtiXp+pIwbLi5I8YUdWDkFQ5VCF1eJ1qTEvcJFxHjE/oUXhKLkRqovlQXp4+lFWmEqhyvfV3YjZ7Z7JFXPTfWKMF4HafyT1HoWgFpma7d/dGVO3oE3V1eHJ7K66OhuDlh/JkQAqCGqRqdn+vgBtqq5xA0oYg7YpqX9AzcegJo6+ASWNQe2DBwjowb11w1m8kcc/oIKgFpma7e8L0KbqGjeg1uugNI9/QC3WQQ0cfQNqsQ5q4gkRUMGswwYEqIme4QHaIA+AtigpALUIDUABqD5Ts/0BKNkBQAGodfDgAc3shH6XdodYBLA6xv5Qw0PcR+g2I+fVpT0EgLY7FIC2iwBAHR8KQNtFAKCODwWg7SK4BRQGc20AFBa0AVBY0AZAYUEbAIUFbXaAlpca0na/vBbbev7nfKbbnV8oNj9tFCOqXKBrbG71WApqoWclvJk6P9VFVecHUHF3reIrP38e7f/G8LRGux+s63eSRHSqx1JQCz0r4U0B9VFdVHX2gPLP2SxaXvsTf9Pvzm3/xhr/nM0/UB+yvPq7jWj5QRnjZ+8TPp4Hn37+2/hE3frL2qkN4iGe9NgJaqOnXlwDdV6qi6zOGlDeRMdvy8vryR1aut2T93l6mff8zHPlh3p59R+z6N+fVWJoz2mU3IYTf9b3b5x5vnuaeEi1gA712Alqo6dWXBN1XqqLrK5VF79/ayv5dOpa92RQczYZdvCbZXifoeo3lle//MXB/S+FGHp7Fp/7OMaNWfzp3LDrsx3psRPURs9qeCN1XqqLrK4FoPO1uAegVWhW+Bux8LhF/2JDp/iff/7P78UYWju4t8b3Tcbe85kNoM70WAlqpaehuHR1PqqLrs6+i4/h5+25SYXeyrqOWfJoFtXuX/x1XYyhL9K15zxnLtmqBXWox0pQKz218CbqfFQXXZ05oDzT3XRYsryyYVKhfFDDR0Dzs+pDYufuqY38fF6h1c4zfgp3z+7fOJuXLhg9VoKs9Yhmoc5HddHVWbSgu0nDHz1bW/v++zOjCo07DX5kPC08pVoES7Xyg8oYOju4z/fZv/n5zd8l80KDCnWux0ZQCz2imavzUF0G6sb2TVJnq9uB2Nj0iEZQB0DDtrHpEW2CgMJGZgAUFrQBUFjQBkBhQRsAdWovDj8otv/7tx4LMlgDoE6tAujLb9/psyRDNQDq1ABoWwOgzmzvIjv0hxjQl68zxk7y15PRq9uMVXp9mNYAqCvbu3gy/n/4wd7FS1H09PAD3oK+un0k3n7t677LNiADoK4s6d1jMP/HcYzp5IAmaQmxMKIBUFeWNJQvvxMT+SLu4g8lgD5NfwzoZN9lG5ABUFeWA7p38dCdvAVF725sANSVJd15/PKCQ/kibUHjt76LNTQDoK5s7+KRZJLEoXz5+qE7fOj56nZMKyg1MQDqzPJlps14BPrHmM5NdiRZZgKfJgZAYUEbAIUFbQAUFrQBUFjQBkBhQRsAhQVtABQWtAFQWNAGQGFBGwCFBW3/BxAywYOYwOYgAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="fitting-with-abc" class="section level4">
<h4>Fitting with ABC</h4>
<p>Now that the observations are loaded, we are ready to fit the model. The fitting algorithm is an “Approximate Bayesian Computation” (ABC). See, for example this <a href="https://en.wikipedia.org/wiki/Approximate_Bayesian_computation">Wikipedia page</a> for more details. We need to define the parameters for this algorithm and, being a Bayesian approach, define the prior distributions of the model parameters we want to fit.</p>
<p>To have a short computation time, we use a low number of iterations. In practice, the number of iterations should be much larger. We are going to equally weight all three data sources. The weights can be any positive number and are used for the penalty calculation within the ABC algorithm. If the levels and number of data points are approximately of the same order, then equal weight really means all data sources will contribute equally in the fitting process. But if, say, one data source has fewer data points, then this is no longer the case. There is no general rule to set the weights, and users may want to explore different alternatives before a final analysis.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>prm.abc <span class="ot">=</span> <span class="fu">define_abc_prms</span>(<span class="at">iter        =</span> <span class="fl">5e2</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">accept      =</span> <span class="fl">3e-2</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">case.weight =</span> <span class="fl">1.0</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ww.weight   =</span> <span class="fl">1.0</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">hosp.weight =</span> <span class="fl">1.0</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">hosp.type   =</span> <span class="st">&#39;hosp.adm&#39;</span>) <span class="co"># &quot;hosp.adm&quot; for hospital admission data. &quot;hosp.occ&quot; for occupancy. NULL for no hospital data to fit.</span></span></code></pre></div>
<p>Now, we define the priors for the model parameters to fit. To do so, a dataframe must be created with a specific format, where a column <code>name</code> defines the name of the model parameter, a column <code>distrib</code> specifies the prior distribution for that parameter (we use the same nomenclature as R, i.e., <code>rnorm</code> for a normal distribution, <code>rexp</code> for exponential, etc.) and a column <code>prms</code> for the parameter associated with the prior distribution (here again, we use the standard R nomenclature and order where <code>1;2</code> specifies <code>mean=1</code> and <code>sd=2</code> if the prior distribution was defined as <code>rnorm</code> ). Note that if more than one parameter is needed to define the prior distribution (for example <code>mean</code> and <code>sd</code> for <code>rnorm</code>), they are separated by a semi-colon.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&#39;R0&#39;</span>, <span class="st">&#39;transm.v_2&#39;</span>, <span class="st">&#39;ww.scale&#39;</span>),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">distrib =</span> <span class="fu">c</span>(<span class="st">&#39;rnorm&#39;</span>, <span class="st">&#39;runif&#39;</span>,  <span class="st">&#39;rnorm&#39;</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">prms =</span> <span class="fu">c</span>(<span class="st">&#39;3;0.2&#39;</span>, <span class="st">&#39;0.1;0.4&#39;</span>, <span class="st">&#39;0.0002;0.0001&#39;</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(priors)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">distrib</th>
<th align="left">prms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">R0</td>
<td align="left">rnorm</td>
<td align="left">3;0.2</td>
</tr>
<tr class="even">
<td align="left">transm.v_2</td>
<td align="left">runif</td>
<td align="left">0.1;0.4</td>
</tr>
<tr class="odd">
<td align="left">ww.scale</td>
<td align="left">rnorm</td>
<td align="left">0.0002;0.0001</td>
</tr>
</tbody>
</table>
<p>In the example above, the model parameter <code>R0</code> has a normal distribution with mean 3 and standard deviation 0.2 as a prior.</p>
<p>Defining the dataframe of prior distributions this way is tedious if there are multiple model parameters to fit, hence the user can call a function that reads the prior definitions directly from a CSV file: <code>define_fit_priors(path=&#39;priordef.csv&#39;)</code> (see its inlne documentation).</p>
<p>We are now ready to fit the model to the data. Note that this step may require a significant computing power for some real-life applications (this example is simple enough that the computing time should be of the order of 1 minute).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fitobj <span class="ot">=</span> <span class="fu">fit</span>(<span class="at">data      =</span> dat,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">prm.abc   =</span> prm.abc,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">prm       =</span> prm.model,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">df.priors =</span> priors,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">n.cores   =</span> <span class="dv">8</span>, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">last.date =</span> <span class="cn">NULL</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R Version:  R version 4.0.4 (2021-02-15) </span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Library deSolve loaded.</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Library stringr loaded.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Library dplyr loaded.</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    user  system elapsed </span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0.59    0.22   14.07</span></span></code></pre></div>
<p>The fit object can then be used to assess the quality of the fit. The function <code>plot_fit_result()</code> plots simulated epidemics with parameters drawn from the posterior distributions and compare them with the data used to fit the model (a good fit should have the simulated epidemics close to the data):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">plot_fit_result</span>(<span class="at">fitobj =</span> fitobj,<span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g<span class="sc">$</span>fitted.observation)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The figure above shows a relatively good fit (lines) compared to the observed data (points). Note that, for the sake of simplicity in this example, we used a simulated epidemic and only blinded three parameters to fit, which made the fitting task particularly fast and easy compared to real-world applications.</p>
<p>It is also possible to visualize the posterior distribution of the parameters fitted:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g<span class="sc">$</span>posterior.dist)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The prior distribution is shown with the light-grey histogram, the posterior with the red histogram.</p>
<p>For more details on the fitting process, the contributions to the ABC penalty from the posterior samples can also be visualized (typically used for fine-tuning the weight of each data source):</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g<span class="sc">$</span>error)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="estimating-the-effective-reproduction-number-r_t" class="section level4">
<h4>Estimating the effective reproduction number (<span class="math inline">\(R_t\)</span>)</h4>
<p>The fitting process shown in this simple example involves estimating the basic reproduction number <span class="math inline">\(R_0\)</span> and the transmission rate <span class="math inline">\(v_2\)</span> relative to its initial value after 55 days (see the model parameters where <span class="math inline">\(b_2=55\)</span>). Those parameters, <span class="math inline">\(R_0\)</span> and the time-dependent transmission rate, are typically not known and hence estimated by fitting the model to data. Once they are estimated, it is possible to infer the effective reproduction number, usually noted <span class="math inline">\(R_t\)</span>. The <span class="math inline">\(R_t\)</span> estimate is based on the posterior distribution of the fitted parameters associated with the transmission process.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Rt <span class="ot">=</span> <span class="fu">estimate_Rt</span>(<span class="at">fitobj=</span>fitobj, <span class="at">ci=</span><span class="fl">0.95</span>, <span class="at">n.cores=</span><span class="dv">4</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;--&gt; Estimating effective reproduction number&quot;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Library deSolve loaded.</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Library stringr loaded.</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Library dplyr loaded.</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the object `Rt` is a dataframe, the function</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># `plot_Rt()` plots its mean and CI estimates:</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>g.Rt <span class="ot">=</span> <span class="fu">plot_Rt</span>(<span class="at">Rdata =</span> Rt,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">min.date =</span> <span class="st">&#39;2021-01-01&#39;</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">max.date =</span> <span class="st">&#39;2021-06-01&#39;</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g.Rt)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The figure above shows the mean estimate for <span class="math inline">\(R_t\)</span> (solid line) and its 95% credible interval (shaded area). In particular its initial value is 3.0, which is the mean posterior estimate for the basic reproduction number <span class="math inline">\(R_0\)</span>. The horizontal dashed line indicates the threshold value 1.0.</p>
</div>
<div id="forecasting" class="section level4">
<h4>Forecasting</h4>
<p>Once the model is fitted to data, we can easily forecast, or project, the future trajectory of the epidemic by simulating forward in time, beyond today, until the forecasting horizon.</p>
<p>Note that if the model has been fitted on wastewater data (in addition to traditional clinical reports), the forecasts/projections will be informed by the wastewater signal (unlike traditional epidemic models that rely exclusively on clinical surveillance data).</p>
<p>First, let’s pretend we have the data only to an earlier date and re-fit the model:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data object censoring </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data beyond the `asof` date:</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>asof <span class="ot">=</span> <span class="fu">ymd</span>(<span class="st">&#39;2021-03-01&#39;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">=</span> dat</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>dat2<span class="sc">$</span>obs <span class="ot">=</span> <span class="fu">filter</span>(dat<span class="sc">$</span>obs, date <span class="sc">&lt;</span> asof)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit on the censored data</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>fitobj2 <span class="ot">=</span> <span class="fu">fit</span>(<span class="at">data     =</span> dat2,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">prm.abc   =</span> prm.abc,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">prm       =</span> prm.model,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">df.priors =</span> priors,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.cores   =</span> <span class="dv">8</span>, </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">last.date =</span> <span class="cn">NULL</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Library deSolve loaded.</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Library stringr loaded.</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Library dplyr loaded.</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    user  system elapsed </span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1.09    0.29   15.58</span></span></code></pre></div>
<p>The function <code>fcst()</code> simulates epidemic trajectories using the posterior distribution of the fitted model parameters at a time horizon beyond the last observation (typically “today”).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ff <span class="ot">=</span> <span class="fu">fcst</span>(<span class="at">fitobj =</span> fitobj2, <span class="at">horizon.fcst =</span> <span class="dv">60</span>, <span class="at">dat =</span> dat2)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>gf <span class="ot">=</span> <span class="fu">plot_fcst</span>(<span class="at">var =</span> <span class="st">&#39;report&#39;</span>, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">fcst.obj =</span> ff, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">dat =</span> dat2)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot differently the &quot;future&quot; observations </span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># to assess the quality of the forecast:</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gf <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">filter</span>(dat<span class="sc">$</span>obs, date <span class="sc">&gt;</span> asof),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">y=</span>clin.obs), </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color=</span><span class="st">&#39;red3&#39;</span>, <span class="at">shape=</span><span class="dv">4</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The figure above shows how the forecast (solid blue line and ribbon) compares with data after the forecast “as of date” (red cross). It also shows how the fit performed (dashed blue line) against the observed past data (black point).</p>
<p><strong>End of the tutorial</strong></p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
